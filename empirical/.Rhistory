#geom_vline(data=mu, aes(xintercept=grp.mean, color=scenario),
#linetype="dashed")+
scale_fill_brewer(palette = 'Dark2', name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
scale_linetype_manual(values = c("dashed", "twodash", "solid", "dotted"), name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
# ggtitle("Public Transport")+
#scale_color_manual(values=c("black", "black","black","black")) +
scale_y_continuous(name ="Probability density")+
scale_x_continuous(name ="Value-of-Safety in km/level", limits = c(-10, 5))+
theme_bw()
ggplot(df, aes(x=vos , fill=mode)) +
geom_histogram(aes(y=..density..), color='grey',alpha=0.5, position = 'identity', binwidth = 0.1) +
geom_density(aes(x = vos, fill = NA, linetype = mode), color='black', size=0.75, alpha=0.6)+
#geom_vline(data=mu, aes(xintercept=grp.mean, color=scenario),
#linetype="dashed")+
scale_fill_brewer(palette = 'Set2', name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
scale_linetype_manual(values = c("dashed", "twodash", "solid", "dotted"), name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
# ggtitle("Public Transport")+
#scale_color_manual(values=c("black", "black","black","black")) +
scale_y_continuous(name ="Probability density")+
scale_x_continuous(name ="Value-of-Safety in km/level", limits = c(-10, 5))+
theme_bw()
ggplot(df, aes(x=vos , fill=mode)) +
geom_histogram(aes(y=..density..), color='grey',alpha=0.5, position = 'identity', binwidth = 0.1) +
geom_density(aes(x = vos, fill = NA, linetype = mode), color='black', size=0.60, alpha=0.6)+
#geom_vline(data=mu, aes(xintercept=grp.mean, color=scenario),
#linetype="dashed")+
scale_fill_brewer(palette = 'Set2', name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
scale_linetype_manual(values = c("dashed", "twodash", "solid", "dotted"), name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
# ggtitle("Public Transport")+
#scale_color_manual(values=c("black", "black","black","black")) +
scale_y_continuous(name ="Probability density")+
scale_x_continuous(name ="Value-of-Safety in km/level", limits = c(-10, 5))+
theme_bw()
# 9. Distribution of random variables
df <- data.frame(x=1:8, y=1, col=letters[1:8])
g <- ggplot(df, aes(x=x, y=y, color=col)) + geom_point(size=5) +
scale_color_brewer(palette="Set2")
colors <- ggplot_build(g)$data[[1]]$colour
plot(df$x, df$y, col=colors, pch=20, cex=5)
f <- function(x) (model_car_TRB[["coefficients"]][["mean.type1"]])
ggplot(data = data.frame(x = c(-12.5, 5)), aes(x)) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_car_TRB[["coefficients"]][["mean.type1"]],
sd = model_car_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 1", linetype = "Function 1"),
size = 1.05)  +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type2"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type2"]], yend = 1,
colour = "Group 1", linetype = "Function 2"), size = 1.05) +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type4"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type4"]], yend = 1,
colour = "Group 1", linetype = "Function 3"), size = 1.05) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type1"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 2", linetype = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type2"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type2"]]), aes(colour = "Group 2", linetype = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type4"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type4"]]), aes(colour = "Group 2", linetype = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type1"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 3", linetype = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type2"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type2"]]), aes(colour = "Group 3", linetype = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type4"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type4"]]), aes(colour = "Group 3", linetype = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type1"]],
sd = model_walk_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 4", linetype = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type2"]],
sd = model_walk_TRB[["coefficients"]][["sd.type2"]]), aes(colour = "Group 4", linetype = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type4"]],
sd = model_walk_TRB[["coefficients"]][["sd.type4"]]), aes(colour = "Group 4", linetype = "Function 3"),
size = 1.05)  +
scale_y_continuous(limits = c(0, 1.00), name = 'Probability density') + theme_bw() + scale_color_manual(values = c(colors[1],colors[2], colors[3], colors[4]),
name = 'Transport Mode',
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
scale_linetype_manual(values = c("dashed", "dotted", "solid"), name = 'Infrastructure type',
labels = c("1: urban road with sidewalk < 1.5 m", "2: urban road with sidewalk >= 1.5 m", "4: shared space") ) + scale_x_continuous(name = 'Beta variable value')
ggplot(data = data.frame(x = c(-12.5, 5)), aes(x)) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_car_TRB[["coefficients"]][["mean.type1"]],
sd = model_car_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 1", linetype = "Function 1"),
size = 1.05)  +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type2"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type2"]], yend = 1,
colour = "Group 1", linetype = "Function 2"), size = 0.9) +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type4"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type4"]], yend = 1,
colour = "Group 1", linetype = "Function 3"), size = 1.05) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type1"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 2", linetype = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type2"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type2"]]), aes(colour = "Group 2", linetype = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type4"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type4"]]), aes(colour = "Group 2", linetype = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type1"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 3", linetype = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type2"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type2"]]), aes(colour = "Group 3", linetype = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type4"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type4"]]), aes(colour = "Group 3", linetype = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type1"]],
sd = model_walk_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 4", linetype = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type2"]],
sd = model_walk_TRB[["coefficients"]][["sd.type2"]]), aes(colour = "Group 4", linetype = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type4"]],
sd = model_walk_TRB[["coefficients"]][["sd.type4"]]), aes(colour = "Group 4", linetype = "Function 3"),
size = 1.05)  +
scale_y_continuous(limits = c(0, 1.00), name = 'Probability density') + theme_bw() + scale_color_manual(values = c(colors[1],colors[2], colors[3], colors[4]),
name = 'Transport Mode',
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
scale_linetype_manual(values = c("dashed", "dotted", "solid"), name = 'Infrastructure type',
labels = c("1: urban road with sidewalk < 1.5 m", "2: urban road with sidewalk >= 1.5 m", "4: shared space") ) + scale_x_continuous(name = 'Beta variable value')
# 9. Distribution of random variables
df <- data.frame(x=1:8, y=1, col=letters[1:8])
g <- ggplot(df, aes(x=x, y=y, color=col)) + geom_point(size=5) +
scale_color_brewer(palette="Dark2")
colors <- ggplot_build(g)$data[[1]]$colour
plot(df$x, df$y, col=colors, pch=20, cex=5)
f <- function(x) (model_car_TRB[["coefficients"]][["mean.type1"]])
ggplot(data = data.frame(x = c(-12.5, 5)), aes(x)) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_car_TRB[["coefficients"]][["mean.type1"]],
sd = model_car_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 1", linetype = "Function 1"),
size = 1.05)  +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type2"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type2"]], yend = 1,
colour = "Group 1", linetype = "Function 2"), size = 0.9) +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type4"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type4"]], yend = 1,
colour = "Group 1", linetype = "Function 3"), size = 1.05) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type1"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 2", linetype = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type2"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type2"]]), aes(colour = "Group 2", linetype = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type4"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type4"]]), aes(colour = "Group 2", linetype = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type1"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 3", linetype = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type2"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type2"]]), aes(colour = "Group 3", linetype = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type4"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type4"]]), aes(colour = "Group 3", linetype = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type1"]],
sd = model_walk_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 4", linetype = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type2"]],
sd = model_walk_TRB[["coefficients"]][["sd.type2"]]), aes(colour = "Group 4", linetype = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type4"]],
sd = model_walk_TRB[["coefficients"]][["sd.type4"]]), aes(colour = "Group 4", linetype = "Function 3"),
size = 1.05)  +
scale_y_continuous(limits = c(0, 1.00), name = 'Probability density') + theme_bw() + scale_color_manual(values = c(colors[1],colors[2], colors[3], colors[4]),
name = 'Transport Mode',
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
scale_linetype_manual(values = c("dashed", "dotted", "solid"), name = 'Infrastructure type',
labels = c("1: urban road with sidewalk < 1.5 m", "2: urban road with sidewalk >= 1.5 m", "4: shared space") ) + scale_x_continuous(name = 'Beta variable value')
# 9. Distribution of random variables
df <- data.frame(x=1:8, y=1, col=letters[1:8])
g <- ggplot(df, aes(x=x, y=y, color=col)) + geom_point(size=5) +
scale_color_brewer(palette="Set1")
colors <- ggplot_build(g)$data[[1]]$colour
plot(df$x, df$y, col=colors, pch=20, cex=5)
f <- function(x) (model_car_TRB[["coefficients"]][["mean.type1"]])
ggplot(data = data.frame(x = c(-12.5, 5)), aes(x)) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_car_TRB[["coefficients"]][["mean.type1"]],
sd = model_car_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 1", linetype = "Function 1"),
size = 1.05)  +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type2"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type2"]], yend = 1,
colour = "Group 1", linetype = "Function 2"), size = 0.9) +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type4"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type4"]], yend = 1,
colour = "Group 1", linetype = "Function 3"), size = 1.05) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type1"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 2", linetype = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type2"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type2"]]), aes(colour = "Group 2", linetype = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type4"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type4"]]), aes(colour = "Group 2", linetype = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type1"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 3", linetype = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type2"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type2"]]), aes(colour = "Group 3", linetype = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type4"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type4"]]), aes(colour = "Group 3", linetype = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type1"]],
sd = model_walk_TRB[["coefficients"]][["sd.type1"]]), aes(colour = "Group 4", linetype = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type2"]],
sd = model_walk_TRB[["coefficients"]][["sd.type2"]]), aes(colour = "Group 4", linetype = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type4"]],
sd = model_walk_TRB[["coefficients"]][["sd.type4"]]), aes(colour = "Group 4", linetype = "Function 3"),
size = 1.05)  +
scale_y_continuous(limits = c(0, 1.00), name = 'Probability density') + theme_bw() +
scale_linetype_manual(values = c("dashed", "twodash", "solid", "dotted"), name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
scale_color_manual(values = c(colors[1],colors[2], colors[3]), name = 'Infrastructure type',
labels = c("1: urban road with sidewalk < 1.5 m", "2: urban road with sidewalk >= 1.5 m", "4: shared space") ) + scale_x_continuous(name = 'Beta variable value')
ggplot(data = data.frame(x = c(-12.5, 5)), aes(x)) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_car_TRB[["coefficients"]][["mean.type1"]],
sd = model_car_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 1", linetype = "Function 1"),
size = 1.05)  +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type2"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type2"]], yend = 1,
linetype = "Group 1", colour = "Function 2"), size = 0.9) +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type4"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type4"]], yend = 1,
linetype = "Group 1", colour = "Function 3"), size = 1.05) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type1"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 2", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type2"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 2", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type4"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 2", colour = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type1"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 3", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type2"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 3", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type4"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 3", colour = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type1"]],
sd = model_walk_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 4", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type2"]],
sd = model_walk_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 4", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type4"]],
sd = model_walk_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 4", colour = "Function 3"),
size = 1.05)  +
scale_y_continuous(limits = c(0, 1.00), name = 'Probability density') + theme_bw() +
scale_linetype_manual(values = c("dashed", "twodash", "solid", "dotted"), name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
scale_color_manual(values = c(colors[1],colors[2], colors[3]), name = 'Infrastructure type',
labels = c("1: urban road with sidewalk < 1.5 m", "2: urban road with sidewalk >= 1.5 m", "4: shared space") ) + scale_x_continuous(name = 'Beta variable value')
ggplot(data = data.frame(x = c(-12.5, 5)), aes(x)) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_car_TRB[["coefficients"]][["mean.type1"]],
sd = model_car_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 1", linetype = "Function 1"),
size = 1.05)  +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type2"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type2"]], yend = 1,
linetype = "Group 1", colour = "Function 2"), size = 0.9) +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type4"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type4"]], yend = 1,
linetype = "Group 1", colour = "Function 3"), size = 1.05) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type1"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 2", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type2"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 2", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type4"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 2", colour = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type1"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 3", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type2"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 3", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type4"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 3", colour = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type1"]],
sd = model_walk_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 4", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type2"]],
sd = model_walk_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 4", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type4"]],
sd = model_walk_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 4", colour = "Function 3"),
size = 1.05)  +
scale_y_continuous(limits = c(0, 1.00), name = 'Probability density') + theme_bw() +
scale_linetype_manual(values = c("dashed", "twodash", "solid", "dotted"), name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
scale_color_manual(values = c(colors[1],colors[2], colors[3]), name = 'Infrastructure type',
labels = c("1: urban road with sidewalk < 1.5 m", "2: urban road with sidewalk >= 1.5 m", "4: shared space") ) + scale_x_continuous(name = 'Beta variable value')
ggplot(data = data.frame(x = c(-12.5, 5)), aes(x)) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_car_TRB[["coefficients"]][["mean.type1"]],
sd = model_car_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 1", colour = "Function 1"),
size = 1.05)  +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type2"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type2"]], yend = 1,
linetype = "Group 1", colour = "Function 2"), size = 0.9) +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type4"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type4"]], yend = 1,
linetype = "Group 1", colour = "Function 3"), size = 1.05) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type1"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 2", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type2"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 2", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type4"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 2", colour = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type1"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 3", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type2"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 3", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type4"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 3", colour = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type1"]],
sd = model_walk_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 4", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type2"]],
sd = model_walk_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 4", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type4"]],
sd = model_walk_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 4", colour = "Function 3"),
size = 1.05)  +
scale_y_continuous(limits = c(0, 1.00), name = 'Probability density') + theme_bw() +
scale_linetype_manual(values = c("dashed", "twodash", "solid", "dotted"), name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
scale_color_manual(values = c(colors[1],colors[2], colors[3]), name = 'Infrastructure type',
labels = c("1: urban road with sidewalk < 1.5 m", "2: urban road with sidewalk >= 1.5 m", "4: shared space") ) + scale_x_continuous(name = 'Beta variable value')
f <- function(x) (model_car_TRB[["coefficients"]][["mean.type1"]])
plot(df$x, df$y, col=colors, pch=20, cex=5)
ggplot(data = data.frame(x = c(-12.5, 5)), aes(x)) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_car_TRB[["coefficients"]][["mean.type1"]],
sd = model_car_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 1", colour = "Function 1"),
size = 1.05)  +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type2"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type2"]], yend = 1,
linetype = "Group 1", colour = "Function 2"), size = 0.9) +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type4"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type4"]], yend = 1,
linetype = "Group 1", colour = "Function 3"), size = 1.05) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type1"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 2", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type2"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 2", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type4"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 2", colour = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type1"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 3", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type2"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 3", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type4"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 3", colour = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type1"]],
sd = model_walk_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 4", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type2"]],
sd = model_walk_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 4", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type4"]],
sd = model_walk_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 4", colour = "Function 3"),
size = 1.05)  +
scale_y_continuous(limits = c(0, 1.00), name = 'Probability density') + theme_bw() +
scale_linetype_manual(values = c("dashed", "twodash", "solid", "dotted"), name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
scale_color_manual(values = c("black",colors[2], colors[1]), name = 'Infrastructure type',
labels = c("1: urban road with sidewalk < 1.5 m", "2: urban road with sidewalk >= 1.5 m", "4: shared space") ) + scale_x_continuous(name = 'Beta variable value')
colors <- ggplot_build(g)$data[[1]]$colour
plot(df$x, df$y, col=colors, pch=20, cex=5)
ggplot(data = data.frame(x = c(-12.5, 5)), aes(x)) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_car_TRB[["coefficients"]][["mean.type1"]],
sd = model_car_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 1", colour = "Function 1"),
size = 1.05)  +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type2"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type2"]], yend = 1,
linetype = "Group 1", colour = "Function 2"), size = 0.9) +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type4"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type4"]], yend = 1,
linetype = "Group 1", colour = "Function 3"), size = 1.05) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type1"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 2", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type2"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 2", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type4"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 2", colour = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type1"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 3", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type2"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 3", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type4"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 3", colour = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type1"]],
sd = model_walk_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 4", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type2"]],
sd = model_walk_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 4", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type4"]],
sd = model_walk_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 4", colour = "Function 3"),
size = 1.05)  +
scale_y_continuous(limits = c(0, 1.00), name = 'Probability density') + theme_bw() +
scale_linetype_manual(values = c("dashed", "twodash", "solid", "dotted"), name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
scale_color_manual(values = c("black",colors[1], colors[3]), name = 'Infrastructure type',
labels = c("1: urban road with sidewalk < 1.5 m", "2: urban road with sidewalk >= 1.5 m", "4: shared space") ) + scale_x_continuous(name = 'Beta variable value')
ggplot(data = data.frame(x = c(-12.5, 5)), aes(x)) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_car_TRB[["coefficients"]][["mean.type1"]],
sd = model_car_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 1", colour = "Function 1"),
size = 1.05)  +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type2"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type2"]], yend = 1,
linetype = "Group 1", colour = "Function 2"), size = 0.9) +
geom_segment(aes(x = model_car_TRB[["coefficients"]][["mean.type4"]], y = 0, xend = model_car_TRB[["coefficients"]][["mean.type4"]], yend = 1,
linetype = "Group 1", colour = "Function 3"), size = 1.05) +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type1"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 2", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type2"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 2", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_ebike_TRB[["coefficients"]][["mean.type4"]],
sd = model_ebike_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 2", colour = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type1"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 3", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type2"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 3", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_escoot_TRB[["coefficients"]][["mean.type4"]],
sd = model_escoot_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 3", colour = "Function 3"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type1"]],
sd = model_walk_TRB[["coefficients"]][["sd.type1"]]), aes(linetype = "Group 4", colour = "Function 1"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type2"]],
sd = model_walk_TRB[["coefficients"]][["sd.type2"]]), aes(linetype = "Group 4", colour = "Function 2"),
size = 1.05)  +
stat_function(fun = dnorm, n = 1000, args = list(mean = model_walk_TRB[["coefficients"]][["mean.type4"]],
sd = model_walk_TRB[["coefficients"]][["sd.type4"]]), aes(linetype = "Group 4", colour = "Function 3"),
size = 1.05)  +
scale_y_continuous(limits = c(0, 1.00), name = 'Probability density') + theme_bw() +
scale_linetype_manual(values = c("dashed", "twodash", "solid", "dotted"), name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
scale_color_manual(values = c("black",colors[1], colors[2]), name = 'Infrastructure type',
labels = c("1: urban road with sidewalk < 1.5 m", "2: urban road with sidewalk >= 1.5 m", "4: shared space") ) + scale_x_continuous(name = 'Beta variable value')
# 5. Plot of main trends: sociodemo and infr. variables
hist_psafe <- function(df){ # function to plot bars, plot the responces.
p<-ggplot(df, aes(x=as.factor(psafe), fill = tmode)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", size = 3,
position = position_stack(vjust = 0.5)) +
scale_y_continuous(name ="Number of responces") +
scale_x_discrete(name ="Perceived Safety") +
scale_fill_brewer(palette = 'Set2', name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) + theme_bw()
return(p)}
hist_psafe_100 <- function(df){
p<-ggplot(df, aes(fill = factor(tmode), x = factor(psafe))) +
geom_bar(position = "fill") +
scale_fill_brewer(palette = 'Set1', name = "Transport Mode",
labels = c("Car", "E-Bike", "E-Scooter", "Walk")) +
geom_text(aes(label = scales::percent(..count../tapply(..count.., ..x.. ,sum)[..x..], accuracy = 0.1)),
position = position_fill(vjust = 0.5),
stat = "count") + theme_bw() +
scale_x_discrete(name ="Perceived Safety") +
scale_y_continuous(name ="Percentage of responces (%)",
labels = function(x) paste0(x*100, "%"))
return(p)}
# histograms: psafe vs mode vs gender (3 dimmensions of psafe)
ggarrange(hist_psafe(subset(data1, gender == 0)) + ggtitle('Females'),
hist_psafe(subset(data1, gender == 1)) + ggtitle('Males'),
hist_psafe(subset(data1, young == 0)) + ggtitle('Not young (>= 30 years)'),
hist_psafe(subset(data1, young == 1)) + ggtitle('Young (< 30 years)'),
hist_psafe(subset(data1, car_own == 1)) + ggtitle('Driving license'),
hist_psafe(subset(data1, car_own == 0)) + ggtitle('No driving license'),
nrow = 3, ncol = 2,
common.legend = TRUE, legend = 'bottom') # so here, we can see different distribution, which is super interesting
df <- data.frame(x=1:8, y=1, col=letters[1:8])
g <- ggplot(df, aes(x=x, y=y, color=col)) + geom_point(size=5) +
scale_color_brewer(palette="Set2")
colors <- ggplot_build(g)$data[[1]]$colour
plot(df$x, df$y, col=colors, pch=20, cex=5)
ggplot(data = data.frame(x = c(-8, 6)), aes(x)) +
stat_function(fun = dnorm, n = 2000, args = list(mean = modecho['ASC_EBIKE', 'Value'],
sd = abs(modecho['SIGMA_ASC_EBIKE', 'Value'])), aes(colour = "Group 1"), size = 0.90) +
stat_function(fun = dnorm, n = 2000, args = list(mean = modecho['ASC_ESCOOT', 'Value'],
sd = abs(modecho['SIGMA_ASC_ESCOOT', 'Value'])), aes(colour = "Group 2"), size = 0.90) +
stat_function(fun = dnorm, n = 2000, args = list(mean = modecho['ASC_WALK', 'Value'],
sd = abs(modecho['SIGMA_ASC_WALK', 'Value'])), aes(colour = "Group 3"), size = 0.90) + theme_bw() +
scale_color_manual(values = c(colors[2], colors[3], colors[4]),
name = 'Transport Mode',
labels = c( "E-Bike", "E-Scooter", "Walk")) +
scale_x_continuous(name = "ASC value") + scale_y_continuous(name = "Probability density")
